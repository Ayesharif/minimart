<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="nav.css">
    <link rel="stylesheet" href="login.css">
</head>
<body>
    <div id="navbar-placeholder"></div>
    <div class="login-container">
        <div class="form-logo">
            <div class="logo-text">üîê MyApp</div>
        </div>

        <h2>Welcome Back</h2>
        <p class="subtitle">Sign in to continue to your account</p>
<p id="message" class=""></p>
        <form id="login-form">
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" placeholder="john@example.com" required>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
            </div>



            <button type="submit" class="btn">Sign In</button>
        </form>



        <div class="register-link">
            Don't have an account? <a href="register.html">Create one</a>
        </div>
    </div>

    <script>


        fetch('nav.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('navbar-placeholder').innerHTML = html;
                loadUser();
            });

        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const message = document.getElementById('message');
            
            // Demo alert - replace with actual login logic
            fetch("http://localhost:3000/login", {
    method: "POST",
    credentials: "include",
    
    // CRITICAL: Tell the server we are sending JSON
    headers: {
        'Content-Type': 'application/json'
    },
    
    body: JSON.stringify({email:email, password:password})
})
.then(response => {
    // 1. Check for bad HTTP status codes (e.g., 400, 500)
    if (!response.ok) {
        throw new Error(`Server responded with status: ${response.status}`);
    }
    // 2. Parse the body as JSON
    return response.json();
})
.then(data => {
    // 3. Handle custom server-side status codes
    message.innerText = data.message;
    
    if (data.status === 1) {
        message.classList.remove("error");
        message.classList.add("success");

        setTimeout(() => {
            window.location.href="index.html"
        }, 2000);
        // Optional: Clear form or redirect user on success
    } else {
        message.classList.remove("success");
        message.classList.add("error");
    }
    console.log("Server Response:", data);
})
.catch(error => {
    // 4. Handle network errors or errors thrown in the promise chain
    message.classList.remove("success");
    message.classList.add("error");
    message.innerText = error.message;
    console.error('Fetch Error:', error.message);
}); 

            alert('Login submitted!\nEmail: ' + email + '\n(This is a demo)');
        });

        // Social button handlers
        document.querySelectorAll('.social-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const provider = this.textContent.trim();
                alert('Login with ' + provider + '\n(This is a demo)');
            });
        });


    </script>
<script src="nav.js"></script>
</body>
</html>